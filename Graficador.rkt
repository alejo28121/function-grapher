#lang racket
(define (Main)
    (struct elements (coefficient potency))
    (define test "-X-3X2-5")
    (define (Graphic table)
        (define tableDate table)
        (define (SearchElements counter prePos tab)
            (define (SearchExpt count preCount)
                (if (equal? (~a (string-ref test count)) "(")
                    (SearchExpt (+ count 2) (+ count 1))
                    (if (< count (string-length test))
                        (if (and (= count preCount) (or (equal? (~a (string-ref test count)) "+") (equal? (~a (string-ref test count)) "X") (equal? (~a (string-ref test count)) "-")))
                            "1"
                            (if (or (equal? (~a (string-ref test count)) "+") (equal? (~a (string-ref test count)) ")") (equal? (~a (string-ref test count)) "X") (equal? (~a (string-ref test count)) "-"))
                                (substring test preCount count)
                                (SearchExpt (+ count 1) preCount)
                            )
                        )
                        (void)
                    )
                )
            )   
            (define (ShowTable count)
                (if (< count (vector-length tab))
                    (begin
                        (printf "~a, ~a\n" (elements-coefficient (vector-ref tab count)) (elements-potency (vector-ref tab count)))
                        (ShowTable (+ count 1))
                    )
                    (void)
                )
            )
            (if (< counter (string-length test)) 
                (if (and (> counter prePos) (or (equal? (~a (string-ref test counter)) "+") (equal? (~a (string-ref test counter)) "X") (equal? (~a (string-ref test counter)) "-")))
                    (if (equal? (~a (string-ref test counter)) "X")
                        (if (equal? (SearchExpt (+ 1 counter) (+ 1 counter)) "1")
                            (SearchElements (+ 1 counter) (+ 1 counter) (vector-append tab (vector (elements (string->number (substring test prePos counter)) (SearchExpt (+ 1 counter) (+ 1 counter))))))
                            (SearchElements (+ (+ 1 (string-length (SearchExpt (+ 1 counter) (+ 1 counter)))) counter) (+ (+ 1 (string-length (SearchExpt (+ 1 counter) (+ 1 counter)))) counter) (vector-append tab (vector (elements (string->number (substring test prePos counter)) (SearchExpt (+ 1 counter) (+ 1 counter))))))
                        )
                        (SearchElements counter counter (vector-append tab (vector (elements (string->number (substring test prePos counter)) 0))))
                    )
                    (if (< counter (- (string-length test) 1))
                        (if (equal? (~a (string-ref test (+ counter 1))) ")")
                            (SearchElements (+ counter 2) (+ counter 2) tab)
                            (SearchElements (+ counter 1) prePos tab)
                        )
                        (SearchElements (+ 1 counter) counter (vector-append tab (vector (elements (string->number (substring test prePos)) 0))))
                    )
                )
                (ShowTable 0)
            )
        )
        (SearchElements 0 0 tableDate)
    )
    (Graphic (vector))
)
(Main)